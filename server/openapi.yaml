openapi: 3.0.3
info:
  title: Aichi Governance API
  version: 1.3.0
servers:
  - url: /
paths:
  /health:
    get:
      summary: Health check
      responses:
        '200': { description: OK }

  /api/v1/meta/version:
    get:
      summary: Get service version and revision info
      responses:
        '200': { description: Version payload }

  /api/v1/bootstrap:
    get:
      summary: Load full bootstrap payload for mockup-compatible frontend
      parameters:
        - in: query
          name: projection
          schema: { type: string, enum: [full, panorama, directory, standards, review] }
        - in: query
          name: sections
          schema: { type: string, description: Comma-separated section names }
        - in: query
          name: review_status
          schema: { type: string }
      responses:
        '200': { description: Bootstrap payload }

  /api/v1/panorama/domains:
    get:
      summary: List panorama domains
      parameters:
        - in: query
          name: health
          schema: { type: string }
        - in: query
          name: priority
          schema: { type: string }
        - in: query
          name: projection
          schema: { type: string, enum: [full, summary, governance] }
        - in: query
          name: fields
          schema: { type: string, description: Comma-separated field projection paths }
      responses:
        '200': { description: Domain list }

  /api/v1/panorama/domains/{id}/systems:
    get:
      summary: List systems under a domain
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
        - in: query
          name: level
          schema: { type: string }
        - in: query
          name: status
          schema: { type: string }
        - in: query
          name: projection
          schema: { type: string, enum: [full, summary, governance] }
        - in: query
          name: fields
          schema: { type: string, description: Comma-separated field projection paths }
      responses:
        '200': { description: Systems list }

  /api/v1/panorama/systems/{id}/architecture:
    get:
      summary: Get system architecture (subsystems and applications)
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
        - in: query
          name: projection
          schema: { type: string, enum: [full, summary, flat] }
      responses:
        '200': { description: Architecture payload }

  /api/v1/panorama/applications/{id}/profile:
    get:
      summary: Get application profile and dependencies
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
        - in: query
          name: projection
          schema: { type: string, enum: [full, basic] }
      responses:
        '200': { description: Application profile }

  /api/v1/panorama/applications/{id}/artifacts:
    get:
      summary: List artifacts of an application
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Artifact list }

  /api/v1/panorama/applications/{id}/tech-components:
    get:
      summary: List tech components used by an application
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Tech component list }

  /api/v1/panorama/applications/{id}/data-objects:
    get:
      summary: List data objects owned by an application
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Data object list }

  /api/v1/panorama/dependency-graph:
    get:
      summary: Get dependency graph
      parameters:
        - in: query
          name: domain_id
          schema: { type: string }
        - in: query
          name: app_id
          schema: { type: string }
        - in: query
          name: depth
          schema: { type: integer }
      responses:
        '200': { description: Graph payload }

  /api/v1/panorama/applications/{id}/impact:
    get:
      summary: Get impact analysis for application
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
        - in: query
          name: change_type
          schema: { type: string }
        - in: query
          name: depth
          schema: { type: integer }
      responses:
        '200': { description: Impact payload }

  /api/v1/panorama/data-centers/summary:
    get:
      summary: List data center summaries
      responses:
        '200': { description: Data center list }

  /api/v1/panorama/applications/{id}/deployment-topology:
    get:
      summary: Get deployment topology of application
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Deployment topology payload }

  /api/v1/panorama/dr-validation:
    get:
      summary: Get DR validation result
      responses:
        '200': { description: DR validation payload }

  /api/v1/panorama/database-clusters:
    get:
      summary: List database clusters
      parameters:
        - in: query
          name: type
          schema: { type: string }
        - in: query
          name: dc_id
          schema: { type: string }
        - in: query
          name: dr
          schema: { type: string }
        - in: query
          name: projection
          schema: { type: string, enum: [full, summary] }
        - in: query
          name: fields
          schema: { type: string, description: Comma-separated field projection paths }
      responses:
        '200': { description: Database clusters }

  /api/v1/panorama/database-clusters/{id}/detail:
    get:
      summary: Get database cluster detail
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Database detail }

  /api/v1/panorama/middleware-clusters:
    get:
      summary: List middleware clusters
      parameters:
        - in: query
          name: type
          schema: { type: string }
        - in: query
          name: health
          schema: { type: string }
        - in: query
          name: projection
          schema: { type: string, enum: [full, summary] }
        - in: query
          name: fields
          schema: { type: string, description: Comma-separated field projection paths }
      responses:
        '200': { description: Middleware clusters }

  /api/v1/panorama/middleware-clusters/{id}/impact:
    get:
      summary: Get middleware impact
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Middleware impact payload }

  /api/v1/panorama/traffic-chain:
    get:
      summary: Get traffic chain by domain
      parameters:
        - in: query
          name: domain
          schema: { type: string }
      responses:
        '200': { description: Traffic chain payload }

  /api/v1/panorama/lb-domains:
    get:
      summary: List load balancer domains
      responses:
        '200': { description: LB domain list }

  /api/v1/panorama/otel-services:
    get:
      summary: List OTel services
      parameters:
        - in: query
          name: app_id
          schema: { type: string }
      responses:
        '200': { description: OTel service list }

  /api/v1/panorama/otel-services/{id}/instances:
    get:
      summary: List instances of an OTel service
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: OTel instance list }

  /api/v1/panorama/tech-radar:
    get:
      summary: Get tech radar buckets
      responses:
        '200': { description: Tech radar payload }

  /api/v1/panorama/tech-debt:
    get:
      summary: Get tech debt list
      responses:
        '200': { description: Tech debt payload }

  /api/v1/panorama/drift-detection:
    get:
      summary: Get runtime drift detection result
      responses:
        '200': { description: Drift payload }

  /api/v1/compliance-rules:
    get:
      summary: List compliance rules
      parameters:
        - in: query
          name: fields
          schema: { type: string, description: Comma-separated field projection paths }
      responses:
        '200': { description: Compliance rule list }

  /api/v1/capabilities:
    get:
      summary: List capabilities
      parameters:
        - in: query
          name: domain_id
          schema: { type: string }
      responses:
        '200': { description: Capability list }

  /api/v1/processes:
    get:
      summary: List processes
      parameters:
        - in: query
          name: capability_id
          schema: { type: string }
      responses:
        '200': { description: Process list }

  /api/v1/data/subject-areas:
    get:
      summary: List subject areas
      responses:
        '200': { description: Subject area list }

  /api/v1/data/logical-entities:
    get:
      summary: List logical entities
      parameters:
        - in: query
          name: subject_area_id
          schema: { type: string }
      responses:
        '200': { description: Logical entity list }

  /api/v1/data/data-objects:
    get:
      summary: List data objects
      parameters:
        - in: query
          name: app_id
          schema: { type: string }
        - in: query
          name: logical_entity_id
          schema: { type: string }
      responses:
        '200': { description: Data object list }

  /api/v1/reviews:
    get:
      summary: List reviews
      parameters:
        - in: query
          name: status
          schema: { type: string }
        - in: query
          name: applicant
          schema: { type: string }
        - in: query
          name: type
          schema: { type: string }
        - in: query
          name: from
          schema: { type: string, format: date }
        - in: query
          name: to
          schema: { type: string, format: date }
        - in: query
          name: projection
          schema: { type: string, enum: [full, summary] }
        - in: query
          name: fields
          schema: { type: string, description: Comma-separated field projection paths }
      responses:
        '200': { description: Review list }
    post:
      summary: Create review draft
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, type]
      responses:
        '201': { description: Review created }

  /api/v1/reviews/{id}/submit:
    put:
      summary: Submit review and run compliance checks
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Submit result }

  /api/v1/reviews/{id}/compliance-check:
    get:
      summary: List compliance checks for review
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Compliance checks }

  /api/v1/reviews/{id}/approve:
    put:
      summary: Approve review
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Approve result }

  /api/v1/reviews/{id}/reject:
    put:
      summary: Reject review
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200': { description: Reject result }

  /api/v1/reviews/dashboard/my-workbench:
    get:
      summary: Get my review workbench metrics
      parameters:
        - in: query
          name: user
          schema: { type: string }
      responses:
        '200': { description: Workbench metrics }

  /api/v1/reviews/dashboard/metrics:
    get:
      summary: Get review dashboard metrics
      responses:
        '200': { description: Metrics payload }
